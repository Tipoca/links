# An ugly page that exercises the various types of input fields in a form.

var theForm = 
 form
   <#>
     <div>
       Flavour: { choice([(1, "Cherry"),
                          (2, "Strawberry"),
                          (77, "Vanilla")]) -> flav }
     </div>
     <div>
       Problems with: <br />{ choices([(2, "Rats"),
                                       (3, "Moles"),
                                       (6, "Neighbours")]) -> problems }
     </div>
     <div>
       { textarea("This is the song that never ends") -> song }
     </div>
       { button("Go", "go") -> go }  { button("Stop", "stop") -> stop }
     <div>
       <label>Over 65? { checkbox -> over65 }</label>
     </div>
   </#>
 yields
    (flav=flav,
     song=song,
     over65=over65,
     do=if (isJust (go)) fromJust (go) else if (isJust (stop)) fromJust (stop) else "",
     problems=problems);

fun renderer ((flav=flav, song=song, over65=over65, do=do, problems=problems)) {
   <#> 
     {intToXml(flav)} <br /> {stringToXml(song)} <br />
     {stringToXml(if (over65) "You are over 65!" else "")}
     {stringToXml(do)}
     Problems: {stringToXml(join(", ", map(intToString, problems)))}
   </#>
}

render(renderer)(theForm)
