# An ugly page that exercises the various types of input fields in a form.

var theForm = 
 form
   <#>
     <div>
       Flavour: { choose([("Cherry", 1),
                          ("Strawberry", 2),
                          ("Vanilla", 77)]) -> flav }
     </div>
     <div>
       Problems with: <br />{ options([("Rats", 2),
                                       ("Moles", 3),
                                       ("Neighbours", 5)]) -> problems }
     </div>
     <div>
       { textarea("This is the song that never ends") -> song }
     </div>
       { button("Go") -> go }  { button("Stop") -> stop }
     <div>
       <label>Over 65? { checkbox -> over65 }</label>
     </div>
   </#>
 yields
    (flav=flav,
     song=song,
     over65=over65,
     do=if (go) "go" else if (stop) "stop" else "",
     problems=problems);

fun renderer ((flav=flav, song=song, over65=over65, do=do, problems=problems)) {
   <#> 
     {intToXml(flav)} <br /> {stringToXml(song)} <br />
     {stringToXml(if (over65) "You are over 65!" else "")}
     {stringToXml(do)}
     Problems: {stringToXml(join(", ", map(intToString, problems)))}
   </#>
}

render(renderer)(theForm)
